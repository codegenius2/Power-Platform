<!DOCTYPE html>
<!--
// =====================================================================
//  This file is part of the Microsoft Dynamics CRM SDK code samples.
//
//  Copyright (C) Microsoft Corporation.  All rights reserved.
//
//  This source code is intended only as a supplement to Microsoft
//  Development Tools and/or on-line documentation.  See these other
//  materials for detailed information regarding Microsoft code samples.
//
//  THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY
//  KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
//  IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A
//  PARTICULAR PURPOSE.
// =====================================================================
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>New Web API preview samples</title>
 <!--<script src="../ClientGlobalContext.js.aspx" type="text/javascript"></script>-->

 <script src="Sdk.WebAPIModelSample.js"></script>
 <script src="Sdk.WebAPISample.js"></script>
 <script src="Sample.js"></script>
 <!--<script src="es6-promise.js"></script>
 <script src="myNameSpace.js"></script>
 <script type="text/javascript">

  document.onreadystatechange = function () {
   if (document.readyState == "complete") {


    createRecordsWithPromises();
   }


   


   function createRecordsWithPromises() {

    var accountUri;
    MyNameSpace.WebAPI.create("accounts", { name: "Sample account" })
    .then(function (aUri) {
     accountUri = aUri;
     console.log("Created account with URI: " + accountUri);
    })
    .then(function () {
     return MyNameSpace.WebAPI.create("tasks", { subject: "Task 1", "regardingobjectid_account_task@odata.bind": accountUri });
    })
    .then(function () {
     return MyNameSpace.WebAPI.create("tasks", { subject: "Task 2", "regardingobjectid_account_task@odata.bind": accountUri });
    })
    .then(function () {
     return MyNameSpace.WebAPI.create("tasks", { subject: "Task 3", "regardingobjectid_account_task@odata.bind": accountUri });
    })
    .catch(function (error) { console.log(error.message); });

   }

   function createRecordsWithCallbacks() {

MyNameSpace.WebAPI.create("accounts",
 { name: "Sample account" },
 function (accountUri) {
  console.log("Created account with URI: " + accountUri);
  MyNameSpace.WebAPI.create("tasks",
   { subject: "Task 1", "regardingobjectid_account_task@odata.bind": accountUri },
   function () {
    MyNameSpace.WebAPI.create("tasks",
     { subject: "Task 2", "regardingobjectid_account_task@odata.bind": accountUri },
     function () {
      MyNameSpace.WebAPI.create("tasks",
       { subject: "Task 3", "regardingobjectid_account_task@odata.bind": accountUri },
       function () {
        //Finished creating three tasks
        console.log("Three tasks created");
       },
      function (error) { console.log(error.message); });
     },
     function (error) { console.log(error.message); });
   },
  function (error) { console.log(error.message); });
 },
function (error) { console.log(error.message); });

  }
  }
 </script>-->
</head>
<body>
 <p>Open the developer tools for your browser to view the output to the console and the HTTP requests and responses.</p>

</body>
</html>